# Diffpkm
Calculate the differential expression of genes by using fpkm/rpkm/tpm/cpm for two group comparison

# Install package
```
devtools::install_github('hzaurzli/Diffpkm')
library(Diffpkm)
```

# How to use Diffpkm
## 1.without NB model to calculate logFoldChange
#### [1].glm model p value calculation
```
data("data")
# treat is the treatment group
treat = data[,1:3]
# control is the control group
control = data[,4:6]
result = cal_diff(treat,control,method = "glm",shrink = F)

result

          Treat_1    Treat_2   Treat_3 Control_1  Control_2 Control_3    logFC        p_val        p,adj
Gene_1   9.168998 40.6542223  6.494375  7.444491 6.66855797 6.7189040 1.434788 5.395155e-02 1.000000e+00
Gene_2  19.655950  3.4254479 52.739200  7.618138 2.92421019 4.9873463 2.287560 1.325098e-02 2.650196e-01
Gene_3  72.357121 26.7231457 68.143043  3.603424 5.53719624 8.6450711 3.232987 2.247679e-09 4.495359e-08
Gene_4   4.426875 91.5598305 56.573256  9.084924 1.37014205 6.7992116 3.144350 2.788986e-03 5.577971e-02
Gene_5   3.485587 55.6122392 81.369367  3.899194 8.22648960 0.5721399 3.467580 2.741380e-03 5.482761e-02
Gene_6  81.364895 58.3585172 29.646583  5.893894 6.75695019 4.7783573 3.280600 1.601472e-10 3.202945e-09
Gene_7  15.648395 91.3456218 25.503929  7.391459 3.91020792 7.6312400 2.807002 1.936954e-04 3.873908e-03
Gene_8  51.295896 96.9578617 31.766921  2.902030 0.48393840 8.8162287 3.882950 2.127887e-07 4.255773e-06
Gene_9  73.491901 95.1658370 52.630370  9.224134 4.93290758 8.4202829 3.292979 1.637155e-17 3.274309e-16
Gene_10 35.228322 17.0702782 16.839530  7.279689 1.88318049 9.8737986 1.860701 4.552902e-04 9.105804e-03
Gene_11 25.636701 43.8891836 32.841739  2.142500 4.23089056 8.6638516 2.767148 2.317405e-10 4.634809e-09
Gene_12 75.291490 62.2583791 82.054535  3.784741 0.10510219 2.5552558 5.090561 1.055756e-18 2.111512e-17
Gene_13  8.608052 32.1660879 73.823465  1.734581 5.53250048 5.3283339 3.185606 1.989149e-04 3.978299e-03
Gene_14 72.793265 98.0866878 46.147087  9.046380 0.01719581 1.4083363 4.373278 1.843331e-08 3.686663e-07
Gene_15 94.116855 21.9074829 29.551971  2.216388 0.48820646 5.8018264 4.097079 2.924627e-06 5.849253e-05
Gene_16 27.323464 11.8033823 51.398272  6.677323 7.31623466 7.9694762 2.043241 4.405745e-04 8.811489e-03
Gene_17 66.353787 52.8402758 62.794364  4.493450 1.10471320 7.5514195 3.790758 3.536471e-20 7.072942e-19
Gene_18 77.868354  0.8073661 31.499290  5.529022 2.05673142 1.2623550 3.638284 5.188957e-03 1.037791e-01
Gene_19 41.133018 41.6323200 62.676640  9.832506 5.18450921 1.1238172 3.171657 4.052762e-13 8.105523e-12
Gene_20 50.613347  9.4147402 79.222878  3.229073 9.21405144 9.2609417 2.681650 7.120254e-04 1.424051e-02
```
#### [2].wlicox p value calculation
```
data("data")
# treat is the treatment group
treat = data[,1:3]
# control is the control group
control = data[,4:6]
result = cal_diff(treat,control,method = "wilcox",shrink = F)

result

          Treat_1    Treat_2   Treat_3 Control_1  Control_2 Control_3    logFC p_val p,adj
Gene_1   9.168998 40.6542223  6.494375  7.444491 6.66855797 6.7189040 1.434788  0.50     1
Gene_2  19.655950  3.4254479 52.739200  7.618138 2.92421019 4.9873463 2.287560  0.25     1
Gene_3  72.357121 26.7231457 68.143043  3.603424 5.53719624 8.6450711 3.232987  0.25     1
Gene_4   4.426875 91.5598305 56.573256  9.084924 1.37014205 6.7992116 3.144350  0.50     1
Gene_5   3.485587 55.6122392 81.369367  3.899194 8.22648960 0.5721399 3.467580  0.50     1
Gene_6  81.364895 58.3585172 29.646583  5.893894 6.75695019 4.7783573 3.280600  0.25     1
Gene_7  15.648395 91.3456218 25.503929  7.391459 3.91020792 7.6312400 2.807002  0.25     1
Gene_8  51.295896 96.9578617 31.766921  2.902030 0.48393840 8.8162287 3.882950  0.25     1
Gene_9  73.491901 95.1658370 52.630370  9.224134 4.93290758 8.4202829 3.292979  0.25     1
Gene_10 35.228322 17.0702782 16.839530  7.279689 1.88318049 9.8737986 1.860701  0.25     1
Gene_11 25.636701 43.8891836 32.841739  2.142500 4.23089056 8.6638516 2.767148  0.25     1
Gene_12 75.291490 62.2583791 82.054535  3.784741 0.10510219 2.5552558 5.090561  0.25     1
Gene_13  8.608052 32.1660879 73.823465  1.734581 5.53250048 5.3283339 3.185606  0.25     1
Gene_14 72.793265 98.0866878 46.147087  9.046380 0.01719581 1.4083363 4.373278  0.25     1
Gene_15 94.116855 21.9074829 29.551971  2.216388 0.48820646 5.8018264 4.097079  0.25     1
Gene_16 27.323464 11.8033823 51.398272  6.677323 7.31623466 7.9694762 2.043241  0.25     1
Gene_17 66.353787 52.8402758 62.794364  4.493450 1.10471320 7.5514195 3.790758  0.25     1
Gene_18 77.868354  0.8073661 31.499290  5.529022 2.05673142 1.2623550 3.638284  0.50     1
Gene_19 41.133018 41.6323200 62.676640  9.832506 5.18450921 1.1238172 3.171657  0.25     1
Gene_20 50.613347  9.4147402 79.222878  3.229073 9.21405144 9.2609417 2.681650  0.25     1
```

## 2.with NB model to calculate logFoldChange
#### [1].glm model p value calculation
```
data("data")
# treat is the treatment group
treat = data[,1:3]
# control is the control group
control = data[,4:6]
result = cal_diff(treat,control,method = "glm",shrink = T)

result

          Treat_1    Treat_2   Treat_3 Control_1  Control_2 Control_3    logFC        p_val        p,adj
Gene_1   9.168998 40.6542223  6.494375  7.444491 6.66855797 6.7189040 1.836622 5.395155e-02 1.000000e+00
Gene_2  19.655950  3.4254479 52.739200  7.618138 2.92421019 4.9873463 2.793592 1.325098e-02 2.650196e-01
Gene_3  72.357121 26.7231457 68.143043  3.603424 5.53719624 8.6450711 3.235614 2.247679e-09 4.495359e-08
Gene_4   4.426875 91.5598305 56.573256  9.084924 1.37014205 6.7992116 3.407558 2.788986e-03 5.577971e-02
Gene_5   3.485587 55.6122392 81.369367  3.899194 8.22648960 0.5721399 3.486260 2.741380e-03 5.482761e-02
Gene_6  81.364895 58.3585172 29.646583  5.893894 6.75695019 4.7783573 3.436710 1.601472e-10 3.202945e-09
Gene_7  15.648395 91.3456218 25.503929  7.391459 3.91020792 7.6312400 3.234502 1.936954e-04 3.873908e-03
Gene_8  51.295896 96.9578617 31.766921  2.902030 0.48393840 8.8162287 3.463808 2.127887e-07 4.255773e-06
Gene_9  73.491901 95.1658370 52.630370  9.224134 4.93290758 8.4202829 3.332764 1.637155e-17 3.274309e-16
Gene_10 35.228322 17.0702782 16.839530  7.279689 1.88318049 9.8737986 1.720784 4.552902e-04 9.105804e-03
Gene_11 25.636701 43.8891836 32.841739  2.142500 4.23089056 8.6638516 2.552892 2.317405e-10 4.634809e-09
Gene_12 75.291490 62.2583791 82.054535  3.784741 0.10510219 2.5552558 4.801232 1.055756e-18 2.111512e-17
Gene_13  8.608052 32.1660879 73.823465  1.734581 5.53250048 5.3283339 3.319636 1.989149e-04 3.978299e-03
Gene_14 72.793265 98.0866878 46.147087  9.046380 0.01719581 1.4083363 3.484497 1.843331e-08 3.686663e-07
Gene_15 94.116855 21.9074829 29.551971  2.216388 0.48820646 5.8018264 3.913389 2.924627e-06 5.849253e-05
Gene_16 27.323464 11.8033823 51.398272  6.677323 7.31623466 7.9694762 2.426139 4.405745e-04 8.811489e-03
Gene_17 66.353787 52.8402758 62.794364  4.493450 1.10471320 7.5514195 3.455286 3.536471e-20 7.072942e-19
Gene_18 77.868354  0.8073661 31.499290  5.529022 2.05673142 1.2623550 4.328954 5.188957e-03 1.037791e-01
Gene_19 41.133018 41.6323200 62.676640  9.832506 5.18450921 1.1238172 3.004767 4.052762e-13 8.105523e-12
Gene_20 50.613347  9.4147402 79.222878  3.229073 9.21405144 9.2609417 2.888848 7.120254e-04 1.424051e-02
```
#### [2].wilcox p value calculation
```
data("data")
# treat is the treatment group
treat = data[,1:3]
# control is the control group
control = data[,4:6]
result = cal_diff(treat,control,method = "wilcox",shrink = T)

result

          Treat_1    Treat_2   Treat_3 Control_1  Control_2 Control_3    logFC p_val p,adj
Gene_1   9.168998 40.6542223  6.494375  7.444491 6.66855797 6.7189040 1.836622  0.50     1
Gene_2  19.655950  3.4254479 52.739200  7.618138 2.92421019 4.9873463 2.793592  0.25     1
Gene_3  72.357121 26.7231457 68.143043  3.603424 5.53719624 8.6450711 3.235614  0.25     1
Gene_4   4.426875 91.5598305 56.573256  9.084924 1.37014205 6.7992116 3.407558  0.50     1
Gene_5   3.485587 55.6122392 81.369367  3.899194 8.22648960 0.5721399 3.486260  0.50     1
Gene_6  81.364895 58.3585172 29.646583  5.893894 6.75695019 4.7783573 3.436710  0.25     1
Gene_7  15.648395 91.3456218 25.503929  7.391459 3.91020792 7.6312400 3.234502  0.25     1
Gene_8  51.295896 96.9578617 31.766921  2.902030 0.48393840 8.8162287 3.463808  0.25     1
Gene_9  73.491901 95.1658370 52.630370  9.224134 4.93290758 8.4202829 3.332764  0.25     1
Gene_10 35.228322 17.0702782 16.839530  7.279689 1.88318049 9.8737986 1.720784  0.25     1
Gene_11 25.636701 43.8891836 32.841739  2.142500 4.23089056 8.6638516 2.552892  0.25     1
Gene_12 75.291490 62.2583791 82.054535  3.784741 0.10510219 2.5552558 4.801232  0.25     1
Gene_13  8.608052 32.1660879 73.823465  1.734581 5.53250048 5.3283339 3.319636  0.25     1
Gene_14 72.793265 98.0866878 46.147087  9.046380 0.01719581 1.4083363 3.484497  0.25     1
Gene_15 94.116855 21.9074829 29.551971  2.216388 0.48820646 5.8018264 3.913389  0.25     1
Gene_16 27.323464 11.8033823 51.398272  6.677323 7.31623466 7.9694762 2.426139  0.25     1
Gene_17 66.353787 52.8402758 62.794364  4.493450 1.10471320 7.5514195 3.455286  0.25     1
Gene_18 77.868354  0.8073661 31.499290  5.529022 2.05673142 1.2623550 4.328954  0.50     1
Gene_19 41.133018 41.6323200 62.676640  9.832506 5.18450921 1.1238172 3.004767  0.25     1
Gene_20 50.613347  9.4147402 79.222878  3.229073 9.21405144 9.2609417 2.888848  0.25     1
```
